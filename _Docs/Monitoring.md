# Monitoring

## Engine
### Messages
#### Status

|Field|Type|Description|
|-----|----|-----------|
|Name|string|Name of the Engine|
|Status|string|"active", "shutdown", "missing"|
|Adapters|string|comma separated list of Adapters currently connected to this Engine|
|Addr|string|Address of the REST interface for the Engine|
|Requests|int|Number of requests processed by the Engine since last startup|

* The Engine sends a Status message every minute.  

#### Requests

|Field|Type|Description|
|-----|----|-----------|
|ID|string|Serial number of the request, generated by the Engine instance|
|Rtype|string|Request type - e.g. "Create", "SearchLL"|
|Status|string|"open", "complete", "error"|
|At|time.Time|The timestamp for the Status transition|
|AreaID|string|The AreaID (e.g. "SJ", "SC") for the request.|

For each REST Request received by the Engine, a minimum of two "Request" messages will be sent to the Monitor:  
1. (Mandatory) Request received (Status=open, At=time.Now())
2. (Optional) If the AreaID is ascertained, an "update" message may be sent (Status=open, AreaID=area, At=0)
2. (Mandatory) Request complete (Status=["complete" or "error"], At=time.Now()).

#### RPCRequests

|Field|Type|Description|
|-----|----|-----------|
|ID|string|A unique ID for the RPC request. It is of the form: "i-t", where "i" is the Request ID (a serial number, as per "Request" above), and "t" is the RPC Transaction ID. For example, a Create request initiates a single RPC call, so it's ID might be: "1001-1".  A "SearchLL" might involve multiple RPC calls, with IDs like: "1002-1", "1002-2". NOTE: the RPC Transaction ID will always begin with "1", and increment up.|
|Status|string|"open", "complete", "error"|
|Route|string|The standard Route (e.g. "CS1-SJ-1"). This is the route to the Adapter and Provider to service the request.|
|At|time.Time|The time the request Status was updated.|

For each REST Request received by the Engine, one or more RPC requests will typically be made.  The following messages are sent for _each_ RPC request:  
1. Request sent (Status=open, At=time.Now())
2. Response received (Status=["complete" or "error"], At=time.Now()).

NOTE: a Services request will not generate an RPC call, as that information is cached be the Engine. However, a Services update call will result in RPC Calls to ALL connected, active Adapters.

## Adapter
### Messages
#### Status

1. Name
2. Type
3. Status
4. _Transaction Count_

#### RPCRequests

1. ID {RequestID, TransID}
2. Status (received, waiting for reply, complete, no response, invalid/error)
3. Elapsed time
4. Route

---

RPC Call

1. Put request in Native format: structs.NCreateRequest
2. r, e := NewRPCCall(service, areaID string, request interface{}, process func(interface{}) error) (*RPCCall, error)
3. r.Run()

Q?) How does Services handle the RPC responses?